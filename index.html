<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI-–ö–æ—Å—Ç—ë—Ä üî•</title>
  <style>
    :root{ --bg:#0b0e14; --muted:#98a2b3; }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:sans-serif;
      background:#0b0e14;
      height:100vh; /* —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —ç–∫—Ä–∞–Ω */
      display:flex;
      align-items:center;
      justify-content:center;
      color:#e5e7eb;
    }
    .container{
      width:100%;
      height:100%; /* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
      display:grid;
      grid-template-columns:360px 1fr;
      gap:16px;
      padding:16px;
    }
    .panel,.scene{
      background:rgba(17,21,29,0.85);
      backdrop-filter:blur(6px);
      border:1px solid #263043;
      border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    .panel{ padding:18px;}
    .scene{
      position:relative;
      aspect-ratio:1/1;
      height:100%;       /* —É–±—Ä–∞–ª–∏ min-height */
      min-height:0;
      overflow:hidden;
    }
    textarea{ width:100%; min-height:120px; resize:vertical; padding:10px; background:#0f1420; border:1px solid #2e3a51; border-radius:10px; color:#e5e7eb; font-size:14px;}
    button{border:0; border-radius:10px; padding:10px 14px; font-weight:700; cursor:pointer; margin-top:6px; margin-right:6px;}
    .start{ background:#10b981; color:#052e2b; }
    .stop{ background:#ef4444; color:#fff; }
    .reset{ background:#334155; color:#e5e7eb; }
    .names-circle{ position:absolute; inset:0; margin:auto; width:100%; height:100%; z-index:6;}
    .name-pill{ position:absolute; transform:translate(-50%,-50%); padding:6px 10px; border-radius:999px; border:1px solid #2e3a51; background:rgba(18,24,38,.85); user-select:none; white-space:nowrap; box-shadow:0 2px 8px rgba(0,0,0,.25); transition:transform .08s ease;}
    .name-pill:hover{ transform:translate(-50%,-50%) scale(1.03); }
    .name-active{ border-color:#ffd166; background:rgba(255,213,102,.2);}
    .ground{ position:absolute; left:50%; top:62%; width:64%; height:30%; transform:translateX(-50%); background:radial-gradient(60% 60% at 50% 100%, rgba(255,170,50,.25), transparent 60%); filter:blur(18px); z-index:1;}
    .fire-wrap{ position:absolute; left:50%; top:60%; transform:translate(-50%,-50%); width:180px; height:auto; z-index:3;}
    .logs{ position:absolute; bottom:-6px; left:50%; transform:translateX(-50%); width:180px; height:50px;}
    .log{ position:absolute; bottom:0; width:120px; height:24px; border-radius:12px; background:linear-gradient(#5a3f2e,#3e2c21);}
    .log.left{ left:8px; transform:rotate(18deg);} .log.right{ right:8px; transform:rotate(-18deg);}
    .flame{ position:relative; width:140px; height:160px; margin:0 auto; filter:drop-shadow(0 0 40px rgba(255,140,0,.5)); display:none;}
    .flame span{ position:absolute; bottom:0; left:50%; transform:translateX(-50%); border-radius:50% 50% 45% 45%; animation:flicker 1s infinite ease-in-out alternate; mix-blend-mode:screen;}
    .f1{ width:120px; height:140px; background:radial-gradient(circle at 50% 70%, #fb8500 0%, rgba(251,133,0,0) 70%); animation-duration:1.4s;}
    .f2{ width:90px; height:110px; background:radial-gradient(circle at 50% 70%, #ffd166 0%, rgba(255,209,102,0) 70%); animation-duration:1.1s;}
    .f3{ width:60px; height:90px; background:radial-gradient(circle at 50% 70%, #fff6cc 0%, rgba(255,255,255,0) 70%); animation-duration:0.9s;}
    @keyframes flicker{ 0%{ transform:translateX(-50%) scale(1) rotate(-2deg); opacity:1;} 50%{ transform:translateX(-50%) scale(1.05) rotate(2deg); opacity:0.8;} 100%{ transform:translateX(-50%) scale(0.95) rotate(-1deg); opacity:1;} }
    canvas#smokeCanvas{ position:absolute; inset:0; width:100%; height:100%; z-index:4; pointer-events:none;}
    .smoke-label{ position:absolute; left:12px; top:12px; right:12px; text-align:center; z-index:7;}
    .stars{ position:absolute; inset:0; background:transparent; z-index:0; pointer-events:none;}
    .evening-award{ margin-top:20px; padding:12px; border-radius:12px; background:rgba(30,40,55,0.85); border:1px solid #2e3a51; font-weight:bold;}
    .tooltip{position:fixed; left:0; top:0; transform:translate(-50%,-120%) scale(.96); background:rgba(15,20,32,.96); padding:6px 10px; border-radius:8px; font-size:12px; color:#e5e7eb; border:1px solid #2e3a51; box-shadow:0 6px 18px rgba(0,0,0,.35); pointer-events:none; opacity:0; transition:opacity .12s ease, transform .12s ease; z-index:9999;}
    .tooltip.show{ opacity:1; transform:translate(-50%,-120%) scale(1); }
    .tooltip::after{ content:""; position:absolute; left:50%; bottom:-6px; transform:translateX(-50%); border:6px solid transparent; border-top-color:#2e3a51; }

    /* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ */
    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
        grid-template-rows: auto 1fr;
      }
      .scene {
        aspect-ratio: auto; /* —É–±–∏—Ä–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ—Å—Ç—å */
        height: 100%;       /* –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É */
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <h1>AI-–ö–æ—Å—Ç—ë—Ä üî•</h1>
      <textarea id="namesInput" placeholder="–í–≤–µ–¥–∏ –∏–º–µ–Ω–∞ –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É"></textarea><br>
      <button id="toggleBtn" class="start">–ü—É—Å–∫</button>
      <button id="resetBtn" class="reset">–°–±—Ä–æ—Å–∏—Ç—å</button>
      <div class="evening-award" id="eveningAward">üèÜ –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –≤–µ—á–µ—Ä–∞: ‚Äî</div>
    </div>
    <div class="scene" id="scene">
      <div class="stars" id="stars"></div>
      <div class="names-circle" id="namesCircle"></div>
      <div class="ground"></div>
      <div class="fire-wrap" id="fire">
        <div class="flame" id="flame">
          <span class="f1"></span>
          <span class="f2"></span>
          <span class="f3"></span>
        </div>
        <div class="logs"><div class="log left"></div><div class="log right"></div></div>
      </div>
      <canvas id="smokeCanvas"></canvas>
      <div class="smoke-label" id="smokeLabel">üî• –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –Ω–∞ –∫–æ—Å—Ç—Ä–µ –ø–æ–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞</div>
    </div>
  </div>
  <div id="tooltip" class="tooltip" aria-hidden="true"></div>

  <script>
    /* —Ç–≤–æ–π JavaScript –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    const namesInput=document.getElementById('namesInput');
    const namesCircle=document.getElementById('namesCircle');
    const smokeLabel=document.getElementById('smokeLabel');
    const eveningAward=document.getElementById('eveningAward');
    const toggleBtn=document.getElementById('toggleBtn');
    const resetBtn=document.getElementById('resetBtn');
    const scene=document.getElementById('scene');
    const canvas=document.getElementById('smokeCanvas');
    const ctx=canvas.getContext('2d');
    const tooltip=document.getElementById('tooltip');
    const flame=document.getElementById('flame');
    let names=[]; let current=null; let running=false;
    let smokeAngle=-Math.PI/2; let times={}; let lastUpdate=Date.now();
    let tickTimer=null; let engineTimer=null; let uiTimer=null;
    let hoveredName=null; let tooltipTimer=null; let particles=[];
    function sizeSceneToCanvas(){ canvas.width=scene.clientWidth; canvas.height=scene.clientHeight; }
    sizeSceneToCanvas(); new ResizeObserver(sizeSceneToCanvas).observe(scene);
    function getCenter(){ return {x:scene.clientWidth/2,y:scene.clientHeight*0.55}; }
    function getRingRadius(){ return Math.min(scene.clientWidth,scene.clientHeight)*0.36; }
    function formatTime(t){ if(t>=60){const m=Math.floor(t/60);const s=Math.floor(t%60);return m+':'+String(s).padStart(2,'0');} return t.toFixed(1)+' —Å–µ–∫'; }
    function accumulatedTime(name){ let t=times[name]||0; if(name===current&&running){t+=(Date.now()-lastUpdate)/1000;} return t; }
    function renderNames(){ namesCircle.innerHTML=''; const c=getCenter(); const R=getRingRadius(); const n=names.length||1;
      for(let i=0;i<names.length;i++){ const angle=(i/n)*Math.PI*2-Math.PI/2; const x=c.x+R*Math.cos(angle); const y=c.y+R*Math.sin(angle);
        const div=document.createElement('div'); div.className='name-pill'+(current===names[i]?' name-active':''); div.textContent=names[i];
        div.style.left=x+'px'; div.style.top=y+'px';
        div.addEventListener('mouseenter',()=>{hoveredName=names[i];showTooltipForElement(div,hoveredName);
          if(!tooltipTimer){tooltipTimer=setInterval(()=>{if(!hoveredName)return;updateTooltipForElement(div,hoveredName);},100);}});
        div.addEventListener('mouseleave',()=>{hoveredName=null;hideTooltip();if(tooltipTimer){clearInterval(tooltipTimer);tooltipTimer=null;}});
        namesCircle.appendChild(div);} }
    function updateNames(){ names=namesInput.value.split('\n').map(s=>s.trim()).filter(s=>s.length>0);
      const newTimes={}; for(const name of names){newTimes[name]=times[name]||0;} times=newTimes; chooseCurrentByAngle(); renderNames(); }
    function chooseCurrentByAngle(){ if(!names.length){current=null; smokeLabel.textContent='üî• –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –Ω–∞ –∫–æ—Å—Ç—Ä–µ –ø–æ–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞'; return;}
      let best=null, bestDiff=Infinity; const n=names.length; for(let i=0;i<n;i++){const angle=(i/n)*Math.PI*2-Math.PI/2;
        const diff=Math.abs(Math.atan2(Math.sin(angle-smokeAngle),Math.cos(angle-smokeAngle))); if(diff<bestDiff){bestDiff=diff;best=names[i];}}
      current=best; if(times[current]===undefined)times[current]=0; smokeLabel.textContent='üî• –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –Ω–∞ –∫–æ—Å—Ç—Ä–µ - '+current; }
    function updateEveningAward(){ let bestName='‚Äî', bestTime=0; for(const [name,val] of Object.entries(times)){
        const t=name===current&&running?val+(Date.now()-lastUpdate)/1000:val; if(t>bestTime){bestTime=t;bestName=name;}}
      eveningAward.textContent='üèÜ –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –≤–µ—á–µ—Ä–∞: '+bestName;
      const nodes=namesCircle.querySelectorAll('.name-pill'); nodes.forEach(n=>n.classList.remove('name-active'));
      const idx=names.indexOf(current); if(idx>=0&&nodes[idx])nodes[idx].classList.add('name-active'); }
    function startEngine(){ if(engineTimer)return; lastUpdate=Date.now();
      engineTimer=setInterval(()=>{const now=Date.now(); const dt=(now-lastUpdate)/1000; lastUpdate=now; if(running&&current){times[current]=(times[current]||0)+dt;}},100);
      uiTimer=setInterval(updateEveningAward,200); }
    function stopEngine(){ if(engineTimer){clearInterval(engineTimer);engineTimer=null;} if(uiTimer){clearInterval(uiTimer);uiTimer=null;} }
    function scheduleNextAngle(){ if(!running)return; const delay=15000+Math.random()*30000;
      tickTimer=setTimeout(()=>{smokeAngle=Math.random()*Math.PI*2-Math.PI; chooseCurrentByAngle(); renderNames(); scheduleNextAngle();},delay); }
    toggleBtn.addEventListener('click',()=>{ if(!running){running=true;toggleBtn.textContent='–°—Ç–æ–ø';toggleBtn.className='stop';flame.style.display='block';scheduleNextAngle();startEngine();}
      else{running=false;toggleBtn.textContent='–ü—É—Å–∫';toggleBtn.className='start';flame.style.display='none'; if(tickTimer){clearTimeout(tickTimer);tickTimer=null;} stopEngine(); updateEveningAward();}});
    resetBtn.addEventListener('click',()=>{running=false;flame.style.display='none';if(tickTimer){clearTimeout(tickTimer);tickTimer=null;} stopEngine();current=null;smokeLabel.textContent='üî• –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –Ω–∞ –∫–æ—Å—Ç—Ä–µ –ø–æ–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞';times={};renderNames();eveningAward.textContent='üèÜ –°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –≤–µ—á–µ—Ä–∞: ‚Äî';hideTooltip();});
    namesInput.addEventListener('input',()=>{updateNames();hideTooltip();}); updateNames();
    function showTooltipForElement(el,name){updateTooltipForElement(el,name);tooltip.classList.add('show');tooltip.setAttribute('aria-hidden','false');}
    function updateTooltipForElement(el,name){const rect=el.getBoundingClientRect();tooltip.textContent=name+' ‚Äî '+formatTime(accumulatedTime(name));tooltip.style.left=(rect.left+rect.width/2)+'px';tooltip.style.top=(rect.top-8)+'px';}
    function hideTooltip(){tooltip.classList.remove('show');tooltip.setAttribute('aria-hidden','true');}
    function spawnParticle(){const c=getCenter(); const angleVariation=(Math.random()-0.5)*0.5;
      particles.push({x:c.x,y:c.y,vx:Math.cos(smokeAngle+angleVariation)*(0.5+Math.random()*1.5),vy:Math.sin(smokeAngle+angleVariation)*(0.5+Math.random()*1.5)-0.6,size:10+Math.random()*25,life:120+Math.random()*80,alpha:1});}
    function animateSmoke(){ctx.clearRect(0,0,canvas.width,canvas.height); for(const p of particles){p.x+=p.vx+(Math.random()-0.5)*0.3;p.y+=p.vy;p.life--;p.alpha=Math.max(0,p.life/200);
        const g=ctx.createRadialGradient(p.x,p.y,p.size*0.2,p.x,p.y,p.size); g.addColorStop(0,`rgba(60,60,60,${p.alpha})`); g.addColorStop(0.5,`rgba(150,150,150,${p.alpha*0.6})`); g.addColorStop(1,`rgba(220,220,220,0)`); ctx.fillStyle=g; ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();}
      particles=particles.filter(p=>p.life>0); if(running&&current&&Math.random()<0.7)spawnParticle(); requestAnimationFrame(animateSmoke);} animateSmoke();
  </script>
</body>
</html>

